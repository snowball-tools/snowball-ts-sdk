{"version":3,"file":"Auth.js","sourceRoot":"","sources":["../../../src/auth/Auth.ts"],"names":[],"mappings":"AAGA,OAAO,EAAE,YAAY,EAAyB,MAAM,YAAY,CAAC;AACjE,OAAO,EAAE,eAAe,EAAE,MAAM,WAAW,CAAC;AAE5C,MAAM,OAAO,IAAI;IAKf,YAAY,KAAY,EAAE,gBAAkC;QAJ5D;;;;;WAAmC;QACnC;;;;;WAAa;QACb;;;;;WAA2B;QAGzB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;QAEzC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;IAC9C,CAAC;IAED,KAAK,CAAC,QAAQ,CAAC,QAAgB;QAC7B,IAAI;YACF,QAAQ,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE;gBAClC,KAAK,YAAY,CAAC,GAAG;oBACnB,OAAO,MAAM,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;gBACpD,KAAK,YAAY,CAAC,OAAO,CAAC;gBAC1B;oBACE,OAAO,OAAO,CAAC,MAAM,CAAC,yBAAyB,CAAC,CAAC;aACpD;SACF;QAAC,OAAO,CAAC,EAAE;YACV,OAAO,CAAC,MAAM,CAAC,sBAAsB,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;SAC3D;IACH,CAAC;IAED,KAAK,CAAC,YAAY;QAChB,IAAI;YACF,QAAQ,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE;gBAClC,KAAK,YAAY,CAAC,GAAG;oBACnB,OAAO,MAAM,IAAI,CAAC,YAAY,CAAC,YAAY,EAAE,CAAC;gBAChD,KAAK,YAAY,CAAC,OAAO,CAAC;gBAC1B;oBACE,OAAO,OAAO,CAAC,MAAM,CAAC,yBAAyB,CAAC,CAAC;aACpD;SACF;QAAC,OAAO,CAAC,EAAE;YACV,OAAO,OAAO,CAAC,MAAM,CAAC,yBAAyB,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;SACrE;IACH,CAAC;IAED,KAAK,CAAC,eAAe;QACnB,IAAI;YACF,QAAQ,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE;gBAClC,KAAK,YAAY,CAAC,GAAG;oBACnB,OAAO,MAAM,IAAI,CAAC,YAAY,CAAC,eAAe,EAAE,CAAC;gBACnD,KAAK,YAAY,CAAC,OAAO,CAAC;gBAC1B;oBACE,OAAO,OAAO,CAAC,MAAM,CAAC,yBAAyB,CAAC,CAAC;aACpD;SACF;QAAC,OAAO,CAAC,EAAE;YACV,OAAO,OAAO,CAAC,MAAM,CAAC,0BAA0B,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;SACtE;IACH,CAAC;IAED,gBAAgB;QACd,QAAQ,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE;YAClC,KAAK,YAAY,CAAC,GAAG,CAAC;YACtB,KAAK,YAAY,CAAC,OAAO,CAAC;YAC1B;gBACE,OAAO,IAAI,eAAe,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;SACjE;IACH,CAAC;IAED,WAAW,CAAC,KAAY;QACtB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;IACvC,CAAC;CACF","sourcesContent":["import type { PKPEthersWallet } from \"@lit-protocol/pkp-ethers\";\nimport type { Chain } from \"../helpers/chains\";\nimport { type SnowballAuth } from \"../snowball\";\nimport { AuthProvider, type AuthProviderInfo } from \"../helpers\";\nimport { SnowballPasskey } from \"./Passkey\";\n\nexport class Auth implements SnowballAuth {\n  authProviderInfo: AuthProviderInfo;\n  chain: Chain;\n  authProvider: SnowballAuth;\n\n  constructor(chain: Chain, authProviderInfo: AuthProviderInfo) {\n    this.chain = chain;\n    this.authProviderInfo = authProviderInfo;\n\n    this.authProvider = this.initAuthProvider();\n  }\n\n  async register(username: string): Promise<void> {\n    try {\n      switch (this.authProviderInfo.name) {\n        case AuthProvider.lit:\n          return await this.authProvider.register(username);\n        case AuthProvider.turnkey:\n        default:\n          return Promise.reject(\"Method not implemented.\");\n      }\n    } catch (e) {\n      Promise.reject(`registering failed ${JSON.stringify(e)}`);\n    }\n  }\n\n  async authenticate(): Promise<void> {\n    try {\n      switch (this.authProviderInfo.name) {\n        case AuthProvider.lit:\n          return await this.authProvider.authenticate();\n        case AuthProvider.turnkey:\n        default:\n          return Promise.reject(\"Method not implemented.\");\n      }\n    } catch (e) {\n      return Promise.reject(`authenticating failed ${JSON.stringify(e)}`);\n    }\n  }\n\n  async getEthersWallet(): Promise<PKPEthersWallet> {\n    try {\n      switch (this.authProviderInfo.name) {\n        case AuthProvider.lit:\n          return await this.authProvider.getEthersWallet();\n        case AuthProvider.turnkey:\n        default:\n          return Promise.reject(\"Method not implemented.\");\n      }\n    } catch (e) {\n      return Promise.reject(`getEthersWallet failed ${JSON.stringify(e)}`);\n    }\n  }\n\n  initAuthProvider(): SnowballAuth {\n    switch (this.authProviderInfo.name) {\n      case AuthProvider.lit:\n      case AuthProvider.turnkey:\n      default:\n        return new SnowballPasskey(this.chain, this.authProviderInfo);\n    }\n  }\n\n  changeChain(chain: Chain) {\n    this.chain = chain;\n    this.authProvider.changeChain(chain);\n  }\n}\n"]}